[{"path":"https://lambdamoses.github.io/VoaygerHackathon/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2020 Sean Davis Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"prerequisites","dir":"Articles","previous_headings":"","what":"Prerequisites","title":"Event info","text":"understand workshop material, expected familiar : Vector, matrix, data frame, list construction operations R Data visualization ggplot2 package Statistics linear algebra, including principal component analysis (PCA) Writing functions R want participate hackathon workshop material either taken documentation websites Voyager SpatialFeatureExperiment soon become part websites. Relevant vignettes linked relevant sections. freely available resources listed helpful understanding workshop; strongly recommend consult unfamiliar topic interest: R Data Science: Intro data wrangling visualization Tidyverse. visualization regular expression parts relevant workshop hackathon. Please read haven’t used ggplot2 . Geocomputation R: Geospatial tools used represent operate geometries raster images SFE. See R package dev workshop page prerequisites system setup hackathon. Please system setup described R package dev workshop hands experience.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"workshop-goals-and-objectives","dir":"Articles","previous_headings":"","what":"Workshop goals and objectives","title":"Event info","text":"Learn technologies collect spatial -omics data, focus transcriptomics Experience exploratory data analysis spatial information front center Get taste geospatial tradition Learn develop R packages Bioconductor","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"what-you-will-learn","dir":"Articles","previous_headings":"Workshop goals and objectives","what":"What you will learn","title":"Event info","text":"Use operate SFE objects Spatial data visualization Geometric operations Create spatial neighborhood graphs Run spatial analyses different fields SFE objects Visualize spatial analysis results Math commonly used ESDA methods Write, document, test R packages Git version control collaborative development","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"what-you-will-not-learn","dir":"Articles","previous_headings":"Workshop goals and objectives","what":"What you will not learn","title":"Event info","text":"Data integration across multiple samples Spatial multi -omics, although Voyager vignette forthcoming Python implementation Voyager","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"to-use-the-docker-image","dir":"Articles","previous_headings":"","what":"To use the Docker image","title":"Event info","text":"workshop can run remotely https://workshop.bioconductor.org/. Create free account log , left menu past events, scroll bottom find workshop, can still accessed afterwards. Alternatively, can run locally Docker image: running, navigate http://localhost:8787/ log rstudio:yourchosenpassword. required packages appropriate version (Bioc 3.19, March 2024) pre-installed Workshop Galaxy Docker image.","code":"# Not working yet as of Fed 27 docker run -e PASSWORD=<choose_a_password_for_rstudio> -p 8787:8787 ghcr.io/lambdamoses/voyagerhackathon"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"location","dir":"Articles","previous_headings":"","what":"Location","title":"Event info","text":"solidarity occupation, colonization injustices inflicted First Nations, acknowledge unceded territory Tongva/Kizh people called territory Tovaangar. Caltech near village Tobpet. Today, Tovaangar/much LA-OC-IE metropolitan area still home many Indigenous people across Turtle Island grateful opportunity live research territory. Recognizing whose land start stop . can reconciliation without conciliation can conciliation without reparations. First Nations, must remember /guests land need better guests. (Abridged el-Tawhid Juma Circle) workshop hackathon located Morgan Library second floor Kerckhoff building Caltech. See map: map, accessible entrance marked pink, north entrance Norman W. Church Laboratory connected Kerckhoff building. elevator marked orange: go corridor entering Church make slight right. coming elevator, make left Morgan Library (marked red box) left, heavy glass doors. Inside Morgan Library library named geneticist Thomas Hunt Morgan, father modern genetics mapped Drosophila genes chromosomes Fly Room Columbia 1920s moving Caltech (said “” instead “” lone genius myth false dangerous). can find schematics historical Drosophila genetic mapping chromosomes 3rd floor building corridor connecting Kerckhoff Church. Comprehensive mapping gene regulation network sea urchin development also performed building Eric H. Davidson lab; sea urchin images can seen corridors building. labs Caltech studying unique model organisms, jellyfish, squid, rove beetles besides sea urchin. honor take molecular biology lab course sea urchin development Eric’s student Peiyun Lee UCLA undergrad (whole mount situ hybridization sea urchin embryos). part glorious tradition workshop extends tradition future. Meanwhile, Caltech admit female students building built (1928), initially women’s restroom. restroom second floor converted women’s restroom bizarre structure. lab (Pachter Lab) used basement building, taking sea urchin lab space Eric passed away. moved Chen building 2021; former Kerckhoff space still empty. moved, women’s restroom basement 1st floor, either walk long way Church building climb 2 floors 2nd floor restroom. recently restroom situation seems fixed; took almost century.","code":""},{"path":[]},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"workshop-on-march-4","dir":"Articles","previous_headings":"Schedule","what":"Workshop on March 4","title":"Event info","text":"’re already hungry, can walk S Lake Ave dinner walking tour Old Pasadena (40 minutes walk Caltech) passing Playhouse District. ’re hungry yet, can walk Old Pasadena dinner .","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"hackathon-on-march-5-8","dir":"Articles","previous_headings":"Schedule","what":"Hackathon on March 5-8","title":"Event info","text":"Morgan Library reserved 9:30 6 pm every day. don’t time; special thing place awesome historical atmosphere current Voyager crew answer questions help . can make new friends. Cool fact: copy first issue Nature . can pull show . March 5 1 pm: Campus tour lunch break","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"food","dir":"Articles","previous_headings":"","what":"Food","title":"Event info","text":"deeply apologize funding provide food March 4, ’ll bring snacks every day. can get three meals campus Red Door Cafe Browne (main dining hall) campus (meal plan required). also numerous restaurants cafes S Lake Ave west campus minutes walk away. map shows restaurants decent vegan options (lighter green though might need ask tahini falafel wraps yogurt ) halal restaurants (darker green) like central Pasadena (red box indicates Morgan Library), click points description: Also, maps show bike paths bike lanes. want wander around LA, also LA food hall fame map , also includes ice cream shops (pink) cafes (brown), click points description. bar enter hall fame much higher previous map. anything, can’t recommend Villa’s Tacos Highland Park (5455 N Figueroa St) enough.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/info.html","id":"la-guide","dir":"Articles","previous_headings":"","what":"LA guide","title":"Event info","text":"town wonder visit hackathon: map shows places like LA, mostly nooks crannies beaten track, obviously biased kinds things like, wilderness, historical buildings, murals, gardens, public art, art galleries. many worlds LA outside Hollywood. Yes, biked places, typically either Pasadena Westwood. part back story behind “geospatial spatial -omics”, can tell breaks.","code":""},{"path":[]},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"resources","dir":"Articles","previous_headings":"Introduction","what":"Resources","title":"Intro to R package development","text":"freely available resources may helpful participating hackathon: R Packages: Please read don’t prior experiences writing R packages. learn structure R packages write documentation unit tests. Advanced R: book give intermediate R users depth understanding R language. Please read want tackle issues marked “advanced”, may involve S4 classes functional programming. Bioconductor developer guide: Explains details requirements Bioconductor packages. R Packages book explains CRAN requirements, Bioconductor different often stringent requirements. Extending ggplot2: Advanced ggplot2 topic relevant plotting image behind geometries Voyager.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"system-setup","dir":"Articles","previous_headings":"Introduction","what":"System setup","title":"Intro to R package development","text":"order participate hackathon, need GitHub account git installed computer. haven’t used git , read Git Basics chapter get started. RStudio GUI git make things easier, default upper right panel R project interest version controlled git. Version control helps keep track changes code merge contributions collaborators. also need install devel version R (4.4.0) RStudio IDE. Devel version R Bioconductor releases tied R versions. Bioconductor two releases every year, synced R release schedule, one late April, late October. April release corresponds bump minor version R (e.g. going 4.3.x 4.4.0). R packages installed one minor version R incompatible different minor version (e.g. packages installed R 4.3.0 still work 4.3.1, work 4.2.x 4.4.0). use one package given Bioconductor release (3.19 upcoming one April), must use package release well. users 6 month period relative stability. Developers introduce breaking changes experimental features devel version (3.19 writing 3.18 current release), changes don’t immediately break users’ code. hackathon uses devel version. Moreover, can install previous versions Bioconductor, corresponding versions R, go back time reproduce analyses old package versions. Bioconductor packages used must Bioconductor release packages checked within release, newer breaking changes dependencies introduced release break old code, thus providing backward compatibility. However, perfect, since CRAN GitHub packages don’t release schedule, ’s possible difficult install old versions CRAN packages. Git version control also makes possible difficult install old versions GitHub packages. Xcode Command Line Tools required Mac users Rtools Windows users need compile dependencies SFE Voyager source, particularly sf package several system dependencies. See instructions install system dependencies sf . Binaries available Windows Mac compilation might necessary. Next git clone repository interest (Run command line (Terminal Mac something like Git Bash PowerShell Windows; RStudio also Terminal pane default bottom left), R console): create directory SpatialFeatureExperiment Voyager source code package located. RStudio, create project, choose Existing Directory, navigate SpatialFeatureExperiment Voyager directory, RStudio open project. Next, RStudio, R console, install devtools (makes easier build, install, test packages development), roxygen2 (generate documentation pages), usethis (makes easier add unit tests vignettes), BiocManager (install manage Bioconductor packages) CRAN: Install devel version Bioconductor: install dependencies; also install packages suggested imported SFE Voyager (.e. soft, optional dependencies) well packages required build test package; can take compiling packages source: See Chapter 2 R Packages details setup. work anything related readXenium() BioFormatsImage class Mac, please read instructions install optional RBioFormats package BioFormats Java library used behind scene Java needs special setup Mac.","code":"# SFE git clone https://github.com/pachterlab/SpatialFeatureExperiment.git  # Voyager git clone https://github.com/pachterlab/voyager.git install.packages(c(\"devtools\", \"roxygen2\", \"usethis\", \"BiocManager\")) BiocManager::install(version = \"devel\") devtools::install_dev_deps()"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"live-demo","dir":"Articles","previous_headings":"","what":"Live demo","title":"Intro to R package development","text":"go Chapter 1 R Packages give glimpses aspects package development. ’s outline:","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"why-write-a-package","dir":"Articles","previous_headings":"Live demo","what":"Why write a package?","title":"Intro to R package development","text":"paraphrase David Robinson, copy paste code 3 times, write function. need change code, need change rather 3 times. extension, copy function 3 times, write package, ’s easier others reuse function. ’s also easier install package CRAN, Bioconductor, GitHub one line code manually download scripts sort things (file paths) work author’s computer. Hence writing package better way share code. Furthermore, R built-infrastructure check package problems (R CMD check). package can also structure analyses. fact, workshop R package although R functions. functions need written data analysis project, package, ’s easier load functions accounting interdependence. workshop material vignettes (long form documentation). ’s also easier install dependencies required versions one line code (dependencies listed DESCRIPTION file) build workshop website pkgdown package designed build package documentation websites (like one Voyager).","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"structure-of-r-packages","dir":"Articles","previous_headings":"Live demo","what":"Structure of R packages","title":"Intro to R package development","text":"DESCRIPTION: Basic info package, including name, version, author info, title, scription, dependencies. Info shown CRAN Bioconductor landing page ckage. NAMESPACE: functions package (.e. dependency) imported ckage? functions package exported user? NEWS.md: new features implemented version LICENSE.md: License, MIT, GPL, BSD, Artistic, etc. README.md: first page see visiting GitHub repo documentation website e package. least describe package install , sometimes also ttle use well, shouldn’t long. ’s long, gnette instead. R: R source code package man: Documentation files, generated automatically roxygen2, don’t edit hand. However, ey used written hand. syntax similar Latex. greatly appreciate roxygen2 ep documentation code together greatly simplify syntax. roxygen2 also gives warnings en problems documentation rendering automatically writes NAMESPACE, ving tedious bookkeeping steps. vignettes: Long form documentation, usually Rmd inst: Put small example datasets code used generate can used sting function examples. Also put citation info . Larger datasets ckages. size limit software packages Bioconductor. src: Code compiled languages used package, usually C /C++, Fortran old ckages. ’s absent ’s R code package. Since R written C rtran, R native interface C Fortran. Rcpp package streamlines interface R C++ RStudio isn’t bad C++ IDE. tests: Unit tests .Rbuildignore: Files ignore building R package, GitHub tions workflow files, RStudio project settings (*.Rproj), kgdown` documentation website build files. .gitignore: Files ignored git version control, usually *.Rproj file anything ecific personal R session R history.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"demo-on-toy-package","dir":"Articles","previous_headings":"Live demo","what":"Demo on toy package","title":"Intro to R package development","text":"Load package informal testing: shift+command+L (Mac), control+shift+L (Windows), devtools::load_all() Render package documentation: shift+command+D (Mac), control+shift+D (Windows), needs setup: Tools Project Options -> Build Tools -> check Generate documentation Roxygen Run unit tests: shift+command+T (Mac), control+shift+T (Windows) “Build” “Git” tabs top right pane RStudio","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"dependencies","dir":"Articles","previous_headings":"Live demo","what":"Dependencies","title":"Intro to R package development","text":"Imports vs. Suggests: Imported packages must installed order install package. contrast, suggested packages don’t installed, code check whether ’re installed calling functions. package uses another package marginal functionality, package suggested instead imported. Try minimize since broken dependency break package dependencies Biocondoctor packages must CRAN Bioconductor rev ed tested, GitHub packages R CMD check: automated check problems package structure, code, documentation. also builds vignettes runs examples unit tests. ’s CRAN software packages Bioconductor every day.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"how-to-write-documentation-with-roxygen2","dir":"Articles","previous_headings":"Live demo","what":"How to write documentation with roxygen2","title":"Intro to R package development","text":"Users future self thank writing documentation. often look cumentation. often write documentation actually implementing function help think really want function Bioconductor requires document arguments exported functions Must document output exported functions exported functions must examples (required Bioconductor required pass R CMD eck) Documenting multiple related functions documentation page Build documentation website pkgdown","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"how-to-debug","dir":"Articles","previous_headings":"Live demo","what":"How to debug","title":"Intro to R package development","text":"Break point: Click space left line numbers RStudio loading package. Next time run code, stop enter debug mode step code inside functions line line see ’s causing error. browser(): Similar breakpoints, put line code code like inspect. helpful debugging S4 methods since RStudio IDE doesn’t work well S4 methods inside setMethod(). S4 methods, say SpatialFeatureExperiment method dimGeometry, S4 class specified signature argument, run debug(dimGeometry, signature = \"SpatialFeatureExperiment\"). thing undebug(). traceback(): Find line code caused recent error series function calls led line code. options(error = recover): get error, can enter debug mode right error occured. Run options(error = NULL) restore default behavior. options(warn = 2): get warning wonder comes , convert warnings errors can use traceback() find warning comes . Run options(warn = 0) restore default behavior.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"why-and-how-to-write-unit-tests","dir":"Articles","previous_headings":"Live demo","what":"Why and how to write unit tests","title":"Intro to R package development","text":"use testthat, unit test frameworks well Use vdiffr unit test plotting functions ’s finicky since requires exact match often doesn’t work geom_sf() requires geospatial systems dependencies can lead subtle differences invisible human eye break vdiffr. Code coverage: percentage code run unit tests, though metric can gamed writing code, try see works. unit tests, save informal tests can run automatically. may initially time consuming tedious, long run saves time makes package stable, fix bug, refactor code, implement new features, can run existing tests one line code clicking one button check new edits broke existing functionalities. Unit tests test functionality separately test isolated possible ’s easier track broke test fails. isolation also forces write modular code. test user facing functions don’t need change tests every time change internals. testing entire workflow rather one functionality, ’s called integration test. However, practice, least R, sometimes find something unit integration tests. tests performed small datasets possible can run quickly daily CRAN Bioconductor check. update dependency R breaks code, likely know unit tests high test coverage. Whenever fix bug, write new unit test. Trying increase code coverage (.e. make sure code tested) make think carefully function behave identify code never used. Finally, unit tests serve documentation well. fact, example code SFE Voyager function documentation often copied unit tests.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"how-to-speed-up-code-optimization","dir":"Articles","previous_headings":"Live demo","what":"How to speed up code (optimization)","title":"Intro to R package development","text":"“Premature optimization root evil”. Need consider user friendliness, readability, d maintainability. Faster != better; analyze data C. Timing code execution (system.time(), microbenchmark, bench) Avoid slow R loops vectorization matrix multiplication Profiling profvis Rcpp primer (time permits): Run usethis::use_rcpp() set package Rcpp. Use Rcpp really loopy code thousands iterations can’t vectorized need use C++ library. many Rcpp* packages make easy use C++ libraries R, RcppArmadillo, RcppEigen, BH, RcppGSL, . Speaking previous point necessarily optimization, check reticulate basilisk call Python code R. can R Python code chunks Rmd Quarto RStudio, can access R objects Python code chunks vice versa.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"other","dir":"Articles","previous_headings":"Live demo","what":"Other","title":"Intro to R package development","text":"pull requests: Suppose want contribute someone else’s package. first make copy package (fork repo), work copy, ’re done request author pull changes (hence ’s called “pull request”) original repo contribution can officially become part package. hackathon, pull requests, review merge pull requests. submit packages Bioconductor (time permits)","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/package.html","id":"voyager-vignette-guidelines","dir":"Articles","previous_headings":"","what":"Voyager vignette guidelines","title":"Intro to R package development","text":"Vignettes main devel branch, documentation documentation-devel branches. Voyager package, vignette pull request fork documentation-devel branch, vignettes development. new vignette ready, merge documentation-devel branch documentation branch, production version Voyager documentation website. Rules documentation-devel branch: purpose branch make pkgdown website longer detailed vignettes make installed size package way large comply Bioconductor’s 5 MB rule. Don’t change anything outside vignettes directory branch. code doesn’t work, change main devel branch merge branch. way large vignettes won’t get main branch code kept consistent, important since pkgdown website also documents functions package. Exception previous rule: may add packages Suggests field DESCRIPTION extra packages used vignettes. file vignettes/ref.bib automatically synced Paperpile. Don’t edit hand.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"spatialfeatureexperiment","dir":"Articles","previous_headings":"","what":"SpatialFeatureExperiment","title":"SpatialFeatureExperiment","text":"SpatialFeatureExperiment (SFE) new S4 class built top SpatialExperiment (SPE). SFE incorporates geometries geometric operations sf package. Examples supported geometries Visium spots represented polygons corresponding size, cell nuclei segmentation polygons, tissue boundary polygons, pathologist annotation histological regions, transcript spots genes. Using sf, SpatialFeatureExperiment leverages GEOS C++ library underlying sf geometry operations, including algorithms determining whether geometries intersect, finding intersection geometries, buffering geometries margins, etc. schematic SFE object shown : list SFE features extend SPE object: colGeometries sf data frames associated entities correspond columns gene count matrix, Visium spots cells. geometries sf data frames can Visium spot centroids, Visium spot polygons, datasets single cell resolution, cell nuclei segmentations. Multiple colGeometries can stored SFE object, one cell segmentation another nuclei segmentation. can non-spatial, attribute columns colGeometry rather colData, sf class allows users specify attributes relate geometries, “constant”, “aggregate”, “identity”. See agr argument st_sf documentation. colGraphs spatial neighborhood graphs cells spots. graphs class listw (spdep package), colPairs SingleCellExperiment used conversion necessary use numerous spatial dependency functions spdep, Moran’s , Geary’s C, Getis-Ord Gi*, LOSH, etc. Conversion also needed classical spatial statistics packages spatialreg adespatial. rowGeometries similar colGeometries, support entities correspond rows gene count matrix, genes. potential use case store transcript spots gene smFISH situ sequencing based datasets. rowGraphs similar colGraphs. potential use case may spatial colocalization transcripts different genes. annotGeometries sf data frames associated dataset directly gene count matrix, tissue boundaries, histological regions, cell nuclei segmentation Visium datasets, etc. geometries stored object facilitate plotting using sf operations find number nuclei Visium spot histological regions Visium spot intersects. Unlike colGeometries rowGeometries, number rows sf data frames annotGeometries constrained dimension gene count matrix can arbitrary. annotGraphs similar colGraphs rowGraphs, entities directly associated gene count matrix, spatial neighborhood graphs nuclei Visium datasets, objects like myofibers. graphs relevant spdep analyses attributes geometries spatial autocorrelation morphological metrics myofibers nuclei. geometry operations sf, attributes results analyses attributes (e.g. spatial regions defined attributes) may related back gene expression. localResults similar reducedDims SingleCellExperiment, stores results univariate bivariate local spatial analysis results, localmoran, Getis-Ord Gi*, local spatial heteroscedasticity (LOSH). Unlike reducedDims, type results (type type analysis Getis-Ord Gi*), feature (e.g. gene) pair features analysis performed results. local spatial analyses can also performed attributes colGeometries annotGeometries addition gene expression colData. Results multivariate spatial analysis MULTISPATI PCA can stored reducedDims.","code":""},{"path":[]},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"x-visium","dir":"Articles","previous_headings":"","what":"10X Visium","title":"SpatialFeatureExperiment","text":"Visium 10X Genomics currently popular spatial transcriptomics technology, workshop uses Visium dataset. Visium, capture sequences spot barcode, unique molecule identifier (UMI), polyT capture poly-adenylated mRNAs printed hexagonal array glass slide. spot barcode known location, spots 55 \\(\\mu m\\) diameter 100 \\(\\mu m\\) apart center center. spots much larger types cells, Visium single cell resolution. Tissue mounted 4 capture areas slide, capture area 4992 spots. spots capture transcripts tissue, reverse transcribed, amplified, sequenced. Space Ranger official software align sequencing reads genome quantify UMIs spot gene. Spatial Ranger also takes histology image capture area, determines spots tissue. user can also manually determine spots tissue Loupe Browser.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"part-1-the-sfe-class","dir":"Articles","previous_headings":"","what":"Part 1: The SFE class","title":"SpatialFeatureExperiment","text":"","code":"library(SpatialFeatureExperiment) library(SFEData)"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"create-an-sfe-object","dir":"Articles","previous_headings":"Part 1: The SFE class","what":"Create an SFE object","title":"SpatialFeatureExperiment","text":"10x Genomics Space Ranger output Visium experiment can read similar manner SpatialExperiment; SpatialFeatureExperiment SFE object spotPoly column geometry spot polygons. filtered matrix (.e. spots tissue) read , column graph called visium also present spatial neighborhood graph Visium spots tissue. graph computed spots read regardless whether tissue. results tissue capture outs directory sample directory. Inside outs directory, directories may present: raw_reature_bc_matrix unfiltered gene count matrix, filtered_feature_bc_matrix gene count matrix spots tissue, spatial spatial information. matrix directories contain matrices MTX format sparse matrices. Space Ranger also outputs matrices h5 files, read R similar way MTX. Inside matrix directory: Inside spatial directory: tissue_lowres_image.png low resolution image tissue. Visium datasets files . barcode_fluorescence_intensity.csv file present datasets fluorescent imaging rather bright field H&E. Space Ranger output includes gene count matrix, spot coordinates, spot diameter. Space Ranger output include nuclei segmentation pathologist annotation histological regions. Extra image processing, ImageJ QuPath, required geometries. See vignette creating SFE objects scratch spatial trancriptomics technologies.","code":"dir <- system.file(\"extdata\", package = \"SpatialFeatureExperiment\") sample_ids <- c(\"sample01\", \"sample02\") (samples <- file.path(dir, sample_ids)) list.files(file.path(samples[1], \"outs\")) list.files(file.path(samples[1], \"outs\", \"filtered_feature_bc_matrix\")) list.files(file.path(samples[1], \"outs\", \"spatial\")) (sfe3 <- read10xVisiumSFE(samples, sample_id = sample_ids, type = \"sparse\",                            data = \"filtered\"))"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"operations-of-sfe-objects","dir":"Articles","previous_headings":"Part 1: The SFE class","what":"Operations of SFE objects","title":"SpatialFeatureExperiment","text":"User interfaces get set geometries spatial graphs emulate reducedDims row/colPairs SingleCellExperiment. Column row geometries also emulate reducedDims internal implementation, annotation geometries spatial graphs differ. Operations SFE objects demonstrated small toy dataset (may need answer prompt R console downloading dataset):","code":"(sfe <- McKellarMuscleData(dataset = \"small\"))"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"column-geometries","dir":"Articles","previous_headings":"Part 1: The SFE class > Operations of SFE objects","what":"Column geometries","title":"SpatialFeatureExperiment","text":"Column geometries colGeometries geometries correspond columns gene count matrix, Visium spots cells datasets single cell resolution technology. SFE object can multiple column geometries. example, dataset single cell resolution, whole cell segmentation nuclei segmentation two different colGeometries. However, Visium, spot polygons colGeometry obviously relevant, though users can add geometries results geometric operations spot polygons. different geometries can get set names, “spotPoly” standard name Visium spot polygons. see colGeometries present SFE object: shorthands specific column row geometries. example, spotPoly(sfe) equivalent colGeometry(sfe, \"spotPoly\") shown .","code":"# Get Visium spot polygons (spots <- colGeometry(sfe, \"spotPoly\")) plot(st_geometry(spots)) # Set colGeometry colGeometry(sfe, \"spotPoly\") <- spots colGeometryNames(sfe) # Getter (spots <- spotPoly(sfe)) # Setter spotPoly(sfe) <- spots"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"annotation","dir":"Articles","previous_headings":"Part 1: The SFE class > Operations of SFE objects","what":"Annotation","title":"SpatialFeatureExperiment","text":"Annotation geometries can get set annotGeometry(). column row geometries, number rows sf data frame (.e. number geometries data frame) constrained number rows columns gene count matrix respectively, just like rowData colData, row rowGeometry colGeometry sf data frame must correspond row column gene count matrix respectively. contrast, annotGeometry sf data frame can dimension, constrained dimension gene count matrix. See annotGeometries present SFE object: shorthands specific annotation geometries. example, tissueBoundary(sfe) equivalent annotGeometry(sfe, \"tissueBoundary\"). cellSeg() (cell segmentation) nucSeg() (nuclei segmentation) first query colGeometries (single cell, single molecule technologies, equivalent colGeometry(sfe, \"cellSeg\") colGeometry(sfe, \"nucSeg\")), found, query annotGeometries (array capture microdissection technologies, equivalent annotGeometry(sfe, \"cellSeg\") annotGeometry(sfe, \"nucSeg\")).","code":"# Getter, by name or index (tb <- annotGeometry(sfe, \"tissueBoundary\")) plot(st_geometry(tb)) # Setter, by name or index annotGeometry(sfe, \"tissueBoundary\") <- tb annotGeometryNames(sfe) # Getter (tb <- tissueBoundary(sfe)) # Setter tissueBoundary(sfe) <- tb"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/sfe.html","id":"spatial-graphs","dir":"Articles","previous_headings":"Part 1: The SFE class > Operations of SFE objects","what":"Spatial graphs","title":"SpatialFeatureExperiment","text":"spatial neighborhood graphs Visium spots stored colGraphs field, similar user interface colGeometries. SFE also wraps methods find spatial neighborhood graph implemented spdep package, triangulation used demonstration. Visium, spatial neighborhood graph hexagonal grid can found known locations barcodes. One SFE object can multiple colGraphs. graphs present SFE object? workshop works one sample, .e. tissue section, operations multiple samples discussed vignette SFE package.","code":"(g <- findSpatialNeighbors(sfe, MARGIN = 2, method = \"tri2nb\")) plot(g, coords = spatialCoords(sfe)) # Set graph by name colGraph(sfe, \"graph1\") <- g # Get graph by name (g <- colGraph(sfe, \"graph1\")) colGraph(sfe, \"visium\") <- findVisiumGraph(sfe) plot(colGraph(sfe, \"visium\"), coords = spatialCoords(sfe)) colGraphNames(sfe) sessionInfo()"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Exploratory spatial data analysis with Voyager","text":"Introduction slides available . rendered version workshop available . following R packages used workshop, CRAN Bioconductor. Bioconductor 3.19 (devel) used workshop.","code":"library(SpatialFeatureExperiment) library(SingleCellExperiment) library(Voyager) library(SFEData) library(scran) library(scater) library(ggplot2) library(rjson) library(Matrix) library(sf) library(scales) library(patchwork) library(BiocParallel) library(tibble) library(tidyr) library(scico) library(pheatmap) library(BiocNeighbors) library(BiocSingular) library(bluster) theme_set(theme_bw())"},{"path":[]},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"dataset","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Dataset","title":"Exploratory spatial data analysis with Voyager","text":"dataset used vignette paper Large-scale integration single-cell transcriptomic data captures transitional progenitor states mouse skeletal muscle regeneration (McKellar et al. 2021). Notexin injected tibialis anterior muscle mice induce injury, healing muscle collected 2, 5, 7 days post injury Visium analysis. dataset vignette timepoint day 2. vignette starts SpatialFeatureExperiment (SFE) object. gene count matrix directly downloaded GEO. 4992 spots, whether tissue , included. H&E image used nuclei myofiber segmentation. subset nuclei randomly selected regions 3 timepoints manually annotated train StarDist model segment rest nuclei, myofibers manually segmented. tissue boundary found thresholding OpenCV, small polygons removed likely debris. Spot polygons constructed spot centroid coordinates diameter Space Ranger output. in_tissue column colData indicates spot polygons intersect tissue polygons, based st_intersects(). Tissue boundary, nuclei, myofiber, Visium spot polygons stored sf data frames SFE object. See vignette SpatialFeatureExperiment details structure SFE object. SFE object dataset provided SFEData package; begin downloading data loading R. H&E image section: image can added SFE object plotted behind geometries, needs flipped align spots origin top left image bottom left geometries.","code":"(sfe <- McKellarMuscleData(\"full\")) sfe <- addImg(sfe, file = \"tissue_lowres_5a.jpeg\", sample_id = \"Vis5A\",                image_id = \"lowres\",                scale_fct = 1024/22208) sfe <- mirrorImg(sfe, sample_id = \"Vis5A\", image_id = \"lowres\")"},{"path":[]},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"spots-in-tissue","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Exploratory data analysis","what":"Spots in tissue","title":"Exploratory spatial data analysis with Voyager","text":"example dataset Visium spots whether tissue , spots intersect tissue used analyses. Total UMI counts (nCounts), number genes detected per spot (nGenes), proportion mitochondrially encoded counts (prop_mito) precomputed colData(sfe). plotSpatialFeature() function can used visualize various attributes space: expression gene, colData values, geometry attributes colGeometry annotGeometry. Visium spots plotted polygons reflecting actual size relative tissue, rather points, case packages plot Visium data. plotting geometries performed hood geom_sf. tissue boundary found thresholding H&E image removing small polygons likely debris. in_tissue column colData(sfe) indicates Visium spot polygon intersects tissue polygon; can found SpatialFeatureExperiment::annotPred(). demonstrate use scran (Lun, Bach, Marioni 2016) normalization , although note necessarily best approach normalizing spatial transcriptomics data. problem normalize spatial transcriptomics data non-trivial , nCounts plot space shows , spatial autocorrelation evident. Furthermore, Visium, reverse transcription occurs situ spots, PCR amplification occurs cDNA dissociated spots. Artifacts may subsequently introduced amplification step, associated spatial origin. Spatial artifacts may arise diffusion transcripts tissue permeablization. However, given total counts seem correspond histological regions, total counts may biological component hence treated technical artifact normalized away scRNA-seq data normalization methods. words, issue normalization spatial transcriptomics data, Visium particular, complex currently unsolved. Myofiber nuclei segmentation polygons available dataset annotGeometries field. Myofibers manually segmented, nuclei segmented StarDist trained manually segmented subset.","code":"names(colData(sfe)) sfe_tissue <- sfe[,colData(sfe)$in_tissue] sfe_tissue <- sfe_tissue[rowSums(counts(sfe_tissue)) > 0,] #clusters <- quickCluster(sfe_tissue) #sfe_tissue <- computeSumFactors(sfe_tissue, clusters=clusters) #sfe_tissue <- sfe_tissue[, sizeFactors(sfe_tissue) > 0] sfe_tissue <- logNormCounts(sfe_tissue) annotGeometryNames(sfe_tissue)"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"from-myofibers-and-nuclei-to-visium-spots","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Exploratory data analysis > Spots in tissue","what":"From myofibers and nuclei to Visium spots","title":"Exploratory spatial data analysis with Voyager","text":"plotSpatialFeature() function can also used plot attributes geometries, .e. non-geometry columns sf data frames rowGeometries, colGeometries, annotGeometries fields SFE object. myofiber polygons annotGeometries can plotted shown , colored cross section area observed tissue section. aes_use argument set color rather fill (default polygons) plot Visium spot outlines make myofiber polygons visible. fill argument set NA make Visium spots look hollow, size argument controls thickness outlines. annot_aes argument specifies column annotGeometry use specify values aesthstic, just like aes ggplot2 (aes_string precise, since tidyeval used ). annot_fixed argument (used ) can set fixed size, alpha, color, etc. annotGeometry. larger myofibers seem fewer total counts, possibly larger size myofibers dilutes transcripts. hints need normalization procedure. SpatialFeatureExperiment, can find number myofibers nuclei intersect Visium spot. predicate can anything implemented sf, example, number nuclei fully covered Visium spot can also found. default predicate st_intersects(). one--one mapping Visium spots myofibers. However, can relate attributes myofibers gene expression detected Visium spots. One way summarize attributes myofibers intersect (choose another better predicate implemented sf) spot, calculate mean, median, sum. can done annotSummary() function SpatialFeatureExperiment. default predicate st_intersects(), default summary function mean(). reveals relationship mean area myofibers intersecting Visium spot aspects spots, total counts gene expression. NAs (gray) designate spots intersecting myofibers, e.g. inflammatory region. nGenes vs. nCounts plot standard QC plot scRNA-seq, see two mysterious branches two clusters nGenes vs. nCounts plot proportion mitochondrial counts vs. nCounts plot. two branches clusters seem related myofiber size.","code":"plotSpatialFeature(sfe_tissue, features = \"nCounts\",                     colGeometryName = \"spotPoly\",                    annotGeometryName = \"myofiber_simplified\",                     aes_use = \"color\", linewidth = 0.5, fill = NA,                    annot_aes = list(fill = \"area\")) colData(sfe_tissue)$n_myofibers <-    annotNPred(sfe_tissue, colGeometryName = \"spotPoly\",              annotGeometryName = \"myofiber_simplified\") plotSpatialFeature(sfe_tissue, features = \"n_myofibers\",                     colGeometryName = \"spotPoly\", image = \"lowres\", color = \"black\",                    linewidth = 0.1) colData(sfe_tissue)$mean_myofiber_area <-    annotSummary(sfe_tissue, \"spotPoly\", \"myofiber_simplified\",                 annotColNames = \"area\")[,1] # it always returns a data frame # The gray spots don't intersect any myofiber plotSpatialFeature(sfe_tissue, \"mean_myofiber_area\", \"spotPoly\", image = \"lowres\",                     color = \"black\", linewidth = 0.1) plotColData(sfe_tissue, x = \"nCounts\", y = \"nGenes\", colour_by = \"mean_myofiber_area\") plotColData(sfe_tissue, x = \"nCounts\", y = \"prop_mito\", colour_by = \"mean_myofiber_area\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exercises","dir":"Articles","previous_headings":"","what":"Exploratory spatial data analysis with Voyager","title":"Exploratory spatial data analysis with Voyager","text":"Use annotNPred() function find number nuclei intersecting Visium spot. nuclei segmentation polygons annotGeometry called “nuclei”. Color Visium spots number nuclei. histological region tends nuclei per Visium spot? number nuclei per spot correlate nCounts?","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"plot-gene-expression-in-space","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Exploratory data analysis > Spots in tissue","what":"Plot gene expression in space","title":"Exploratory spatial data analysis with Voyager","text":"Marker genes: Myh7 (Type , slow twitch, aerobic), Myh2 (Type IIa, fast twitch, somewhat aerobic), Myh4 (Type IIb, fast twitch, anareobic), Myh1 (Type IIx, fast twitch, anaerobic), protocol (Wang, Yue, Kuang 2017) first examine Type myofibers. fast twitch muscle, don’t expect many slow twitch Type myofibers. Row names sfe_tissue Ensembl IDs order avoid ambiguity sometimes multiple Ensembl IDs gene symbol genes aliases. However, gene symbols shorter human readable Ensembl IDs, better suited display plots. plotSpatialFeature() function functions Voyager, even row names recorded Ensembl IDs, features argument can take gene symbols column rowData(sfe) gene symbols supplied swap_rownames argument. function Voyager queries genes swap_rownames argument.","code":"markers <- c(I = \"Myh7\", IIa = \"Myh2\", IIb = \"Myh4\", IIx = \"Myh1\") plotSpatialFeature(sfe_tissue, \"Myh2\", \"spotPoly\",                    annotGeometryName = \"myofiber_simplified\",                     annot_aes = list(fill = \"area\"), swap_rownames = \"symbol\",                     exprs_values = \"logcounts\", aes_use = \"color\", linewidth = 0.5,                    fill = NA)"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exercises-1","dir":"Articles","previous_headings":"","what":"Exploratory spatial data analysis with Voyager","title":"Exploratory spatial data analysis with Voyager","text":"exprs_values argument specifies assay use, default “logcounts”, .e. log normalized data. default may may suitable practice given total UMI counts may biological relevance spatial data. Plot one marker genes , “counts” assay. Look documentation plotSpatialFeature(). Try plotting Visium spots filled circles partially transparent.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"spatial-neighborhood-graphs","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Spatial neighborhood graphs","title":"Exploratory spatial data analysis with Voyager","text":"spatial neighborhood graph required compute spatial dependency metrics Moran’s Geary’s C. SpatialFeatureExperiment package wraps methods spdep find spatial neighborhood graphs, stored within SFE object (see spdep documentation gabrielneigh(), knearneigh(), poly2nb(), tri2nb()). Voyager package uses graphs spatial dependency analyses, based spdep first version, methods geospatial packages, also use spatial neighborhood graphs, may added later. Visium, spots hexagonal grid, spatial neighborhood graph straightforward. However, spatial technologies single cell resolution, e.g. MERFISH, different methods can used find spatial neighborhood graph. example, method “poly2nb” used myofibers, identifies myofiber polygons physically touch . zero.policy = TRUE allow singletons, .e. nodes without neighbors graph; inflamed region, singletons. yet benchmarked spatial neighborhood construction methods determine “best” different technologies; particular method used demonstration purposes may best practice: plotColGraph() function plots graph space associated colGeometry, along geometry interest. Similarly, plotAnnotGraph() function plots graph associated annotGeometry, along geometry interest. plotRowGraph yet since haven’t worked dataset spatial graphs related genes relevant, although SFE object supports row graphs.","code":"colGraph(sfe_tissue, \"visium\") <- findVisiumGraph(sfe_tissue) annotGraph(sfe_tissue, \"myofiber_poly2nb\") <-    findSpatialNeighbors(sfe_tissue, type = \"myofiber_simplified\", MARGIN = 3,                        method = \"poly2nb\", zero.policy = TRUE) plotColGraph(sfe_tissue, colGraphName = \"visium\", colGeometryName = \"spotPoly\") +     theme_void() plotAnnotGraph(sfe_tissue, annotGraphName = \"myofiber_poly2nb\",                 annotGeometryName = \"myofiber_simplified\") + theme_void()"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exploratory-spatial-data-analysis","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Exploratory spatial data analysis","title":"Exploratory spatial data analysis with Voyager","text":"spatial autocorrelation metrics package can computed directly vector matrix rather SFE object. user interface emulates dimension reductions scater package (e.g. calculateUMAP() takes matrix SCE object returns matrix, runUMAP() takes SCE object adds results reducedDims field SCE object). calculate* functions take matrix SFE object directly return results (format results depends structure results), run* functions take SFE object add results object. addition, colData* functions compute metrics numeric variables colData. colGeometry* functions compute metrics numeric columns colGeometry. annotGeometry* functions compute metrics numeric columns annotGeometry.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"univariate-global","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Univariate global","title":"Exploratory spatial data analysis with Voyager","text":"Voyager supports many univariate global spatial autocorrelation implemented spdep ESDA: Moran’s Geary’s C, permutation testing Moran’s Geary’s C, Moran plot, correlograms. addition, beyond spdep, Voyager can cluster Moran plots correlograms. Plotting functions taking SFE objects implemented plot results ggplot2 customization options spdep plotting functions. functions calculateUnivariate() (can take data outside SFE objects), runUnivariate() (gene expression), colDataUnivariate(), colGeometryUnivariate(), annotGeometryUnivariate(), reducedDimUnivariate() compute univariate spatial statistics different fields SFE object, arguments except arguments specific field SFE object. argument type, indicates corresponding function names spdep, determines spatial statistics computed. univariate global methods Voyager listed : calling calculate*variate() run*variate(), type (2nd) argument takes string matches entry name column data frame returned listSFEMethods(). demonstrate spatial autocorrelation gene expression, top highly variable genes (HVGs) used. HVGs found scran method. global statistic yields one result entire dataset.","code":"listSFEMethods(variate = \"uni\", scope = \"global\") dec <- modelGeneVar(sfe_tissue) hvgs <- getTopHVGs(dec, n = 50)"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"morans-i","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Univariate global","what":"Moran’s I","title":"Exploratory spatial data analysis with Voyager","text":"reference, Pearson correlation defined \\[ \\rho_{X,Y} = \\frac{\\sum_{=1}^n\\sum_{j=1}^n (x_i - \\bar x)(y_i - \\bar y)}{\\sqrt{\\sum_{=1}^n (x_i - \\bar x)^2}\\sqrt{\\sum_{=1}^n (y_i - \\bar y)^2}}. \\] several ways quantify spatial autocorrelation, common Moran’s (Moran 1950): \\[ = \\frac{n}{\\sum_{=1}^n \\sum_{j=1}^n w_{ij}} \\frac{\\sum_{=1}^n \\sum_{j=1}^n w_{ij} (x_i - \\bar{x})(x_j - \\bar{x})}{\\sum_{=1}^n (x_i - \\bar{x})^2}, \\] \\(n\\) number spots locations, \\(\\) \\(j\\) different locations, spots Visium context, \\(x\\) \\(y\\) variables values location, \\(w_{ij}\\) spatial weight, can inversely proportional distance spots indicator whether two spots neighbors, subject various definitions neighborhood whether normalize number neighbors. spdep package uses neighborhood. Moran’s analogous Pearson correlation value location average value neighbors (identical, see (Lee 2001)). Just like Pearson correlation, Moran’s generally bound -1 1, positive value indicates positive spatial autocorrelation, .e. nearby values tend similar, negative value indicates negative spatial autocorrelation, .e. nearby values tend dissimilar. Upon visual inspection earlier workshop, total UMI counts per spot (nCounts) seem spatial autocorrelation. numeric columns colData(sfe), univariate methods can called colDataUnivariate(). compute Moran’s nCounts nGenes: colData, results added colFeatureData(sfe), features Moran’s calculated NA. column names featureData distinguishes different samples (’s one sample dataset), parsed plotting functions. first column Moran’s value, indicates moderate positive spatial autocorrelation nCounts nGenes. second column kurtosis data. Compute Moran’s attributes geometries: “area” area cross section myofiber seen tissue section “eccentricity” eccentricity ellipse fitted myofiber. non-geometry column colGeometry, colGeometryUnivariate() like annotGeometryUnivariate() , none colGeometries dataset extra columns. gene expression, logcounts assay used default (use exprs_values argument change assay), though may may best practice. metrics computed large number features, parallel computing supported, BiocParallel, BPPARAM argument. Moran’s commonly used, runMoransI(sfe_tissue, features = hvgs) equivalent runUnivariate(sfe_tissue, type = \"moran\", features = hvgs).","code":"sfe_tissue <- colDataUnivariate(sfe_tissue, type = \"moran\",                                  features = c(\"nCounts\", \"nGenes\"),                                 colGraphName = \"visium\") colFeatureData(sfe_tissue)[c(\"nCounts\", \"nGenes\"),] # Remember zero.policy = TRUE since there're singletons sfe_tissue <- annotGeometryUnivariate(sfe_tissue, type = \"moran\",                                       features = c(\"area\", \"eccentricity\"),                                        annotGeometryName = \"myofiber_simplified\",                                       annotGraphName = \"myofiber_poly2nb\",                                        zero.policy = TRUE) attr(annotGeometry(sfe_tissue, \"myofiber_simplified\"), \"featureData\")[c(\"area\", \"eccentricity\"),] sfe_tissue <- runUnivariate(sfe_tissue, type = \"moran\", features = hvgs,                              colGraphName = \"visium\", BPPARAM = SerialParam()) rowData(sfe_tissue)[head(hvgs),c(\"moran_Vis5A\", \"K_Vis5A\", \"symbol\")]"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exercises-2","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Univariate global","what":"Exercises","title":"Exploratory spatial data analysis with Voyager","text":"Use listSFEMethods() find “name” Geary’s C (Geary 1954). name used type argument runUnivariate(). Compute Geary’s C highly variable genes, show results. Interpretation Geary’s C: value 1 indicates positive spatial autocorrelation, value 1 indicates negative spatial autocorrelation.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"further-reading","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Univariate global","what":"Further reading","title":"Exploratory spatial data analysis with Voyager","text":"Spatial transcriptomics data usually much larger typical geospatial dataset back 1950s Moran’s Geary’s C devised. See (Luo, Griffith, Wu 2019) asymptotic properties Moran’s large datasets normal skewed distributions. negative binomial distribution often used model transcriptomics data due bursts transcription, although Poisson distribution sometimes used instead simplify math. See (Griffith Haining 2006) consideration Poisson distribution spatial analyses. Moran’s exactly Pearson correlation values spatially smoothed values. bounds Moran’s depend spatial neighborhood graph. Usually upper bound around 1, lower bound closer -0.5 -1. See (Jong, Sprenger, Veen 1984) derivation extreme values Moran’s Geary’s C. Spatial autocorrelation decays different length scales different features, correlogram one way find length scales. vignettes use correlograms. Also see vignette Moran’s flipping signs different length scales.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"univariate-local","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Univariate local","title":"Exploratory spatial data analysis with Voyager","text":"Local statistics yield result location rather whole dataset, global statistics may obscure local heterogeneity. See (Fotheringham 2009) interesting discussion relationships global local spatial statistics. Local statistics stored localResults field SFE object, can accessed localResult() localResults() functions SpatialFeatureExperiment package. univariate local methods Voyager listed :","code":"listSFEMethods(variate = \"uni\", scope = \"local\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"local-morans-i","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Univariate local","what":"Local Moran’s I","title":"Exploratory spatial data analysis with Voyager","text":"recap, global Moran’s defined \\[ = \\frac{n}{\\sum_{=1}^n \\sum_{j=1}^n w_{ij}} \\frac{\\sum_{=1}^n \\sum_{j=1}^n w_{ij} (x_i - \\bar{x})(x_j - \\bar{x})}{\\sum_{=1}^n (x_i - \\bar{x})^2}. \\] Local Moran’s (Anselin 1995) defined \\[ I_i = (n-1)\\frac{(x_i - \\bar{x})\\sum_{j=1}^n w_{ij} (x_j - \\bar{x})}{\\sum_{=1}^n (x_i - \\bar{x})^2}. \\] ’s similar global Moran’s , values locations \\(\\) summed ’s normalization sum spatial weights. Local Moran’s used spatial transcriptomics MERINGUE package (Miller et al. 2021). compute local Moran’s gene Myh2. useful plot log normalized Myh2 gene expression context interpret local results: local spatial results can plotted plotLocalResults(), similar plotSpatialFeature(). divergent palette used Moran’s sensible center 0 (actually expected value Moran’s -1/(n-1) mean unknown, ’s close 0 n typically large spatial -omics). see myofiber regions higher Myh2 expression also stronger spatial autocorrelation, injury site locally negative spatial autocorrelation. results stored localResults field SFE object, getters setters analogous reducedDims, name local method feature/gene local method run need specified well. interesting see spatial autocorrelation relates gene expression level, much finding variance relates mean expression gene, usually indicates overdispersion compared Poisson scRNA-seq Visium data: gene, Visium spots higher expression also tend higher local Moran’s , may may apply genes. vertical dashed line marks mean gene expression; note subtraction mean expression global local Moran’s , leading spots close mean local Moran’s close 0. Local spatial analyses often return matrix data frame. plotLocalResult() function default column local spatial method, columns can plotted well. Use localResultAttrs() function see columns present, use attribute argument specify column plot. local spatial methods return p-values location, column name like Pr(z != E(Ii)), test two sided (default, can changed alternative argument runUnivariate() passed relevant underlying function spdep). Negative log p-value computed facilitate visualization (smaller significant p-values plotted higher values), p-value corrected multiple hypothesis testing p.adjustSP() spdep, number tests number neighbors location rather total number locations (-log10p_adj). plot following plots p-values, divergent palette used show locations significant adjusting multiple testing significant different colors. center divergent palette p = 0.05, brown spots significant dark blue means really significant. “pysal” column shows type neighborhood, whether low value near low values, high value near high values.","code":"sfe_tissue <- runUnivariate(sfe_tissue, type = \"localmoran\", features = \"Myh2\",                             colGraphName = \"visium\", swap_rownames = \"symbol\") plotSpatialFeature(sfe_tissue, features = \"Myh2\", colGeometryName = \"spotPoly\",                    swap_rownames = \"symbol\", image_id = \"lowres\", color = \"black\",                    linewidth = 0.1) plotLocalResult(sfe_tissue, \"localmoran\", features = \"Myh2\",                  colGeometryName = \"spotPoly\", divergent = TRUE,                 diverge_center = 0, image_id = \"lowres\",                  swap_rownames = \"symbol\", color = \"black\",                 linewidth = 0.1) lr <- localResult(sfe_tissue, type = \"localmoran\", feature = \"Myh2\",                    swap_rownames = \"symbol\") head(lr) df <- data.frame(myh2 = logcounts(sfe_tissue)[rowData(sfe_tissue)$symbol == \"Myh2\",],                  Ii = localResult(sfe_tissue, \"localmoran\", \"Myh2\",                                    swap_rownames = \"symbol\")[,\"Ii\"]) ggplot(df, aes(myh2, Ii)) + geom_point(alpha = 0.3) +     geom_vline(xintercept = mean(df$myh2), linetype = 2, color = \"gray\") +     geom_hline(yintercept = 0, linetype = 2, color = \"gray\") +     labs(x = \"Myh2 (log counts)\", y = \"localmoran\") localResultAttrs(sfe_tissue, \"localmoran\", \"Myh2\", swap_rownames = \"symbol\") plotLocalResult(sfe_tissue, \"localmoran\", features = \"Myh2\",                  colGeometryName = \"spotPoly\", attribute = \"-log10p_adj\", divergent = TRUE,                 diverge_center = -log10(0.05), swap_rownames = \"symbol\",                 image_id = \"lowres\", color = \"black\",                 linewidth = 0.1) plotLocalResult(sfe_tissue, \"localmoran\", features = \"Myh2\",                  colGeometryName = \"spotPoly\", attribute = \"pysal\",                  swap_rownames = \"symbol\", image_id = \"lowres\", color = \"black\",                 linewidth = 0.1)"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exercises-3","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Univariate local","what":"Exercises","title":"Exploratory spatial data analysis with Voyager","text":"Compute local spatial heteroscedasticity (LOSH) (J. Keith Ord Getis 2012) Myh2 plot results. sequential palette appropriate. columns returned LOSH? Plot one space. See documentation spdep::LOSH() meanings columns. spatial pattern LOSH compare local Moran genes?","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"further-reading-1","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Univariate local","what":"Further reading","title":"Exploratory spatial data analysis with Voyager","text":"Getis-Ord Gi* (J. K. Ord Getis 1995) another commonly used local spatial statistic identifies hotspots (high values clustered together space) coldspots (low values clostered space). vignettes use Getis-Ord Gi*. Moran scatter plot (Anselin 1996) another ESDA tool. Voyager special function plot results moranPlot(). See vignettes examples Moran scatter plot applied spatial transcriptomics. Analogous Moran scatter plot Geary scatter plot (yet implemented Voyager) proposed (Griffith Chun 2022) said better detect local negative spatial autocorrelation. paper also includes considerations Moran’s Geary’s C.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"bivariate","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Bivariate","title":"Exploratory spatial data analysis with Voyager","text":"spatial methods analyze two variables relate. list bivariate global methods can seen : also local bivariate methods:","code":"listSFEMethods(variate = \"bi\", scope = \"global\") listSFEMethods(variate = \"bi\", scope = \"local\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"lees-l","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Bivariate","what":"Lee’s L","title":"Exploratory spatial data analysis with Voyager","text":"Lee’s L (Lee 2001) developed relating Moran’s Pearson correlation, defined \\[ L_{X,Y} = \\frac{n}{\\sum_{=1}^n \\sum_{j=1}^n w_{ij}} \\frac{\\sum_{=1}^n \\left[ \\sum_{j=1}^n w_{ij}  (x_j - \\bar{x}) \\right] \\left[ \\sum_{j=1}^n w_{ij} (y_j - \\bar{y}) \\right]}{\\sqrt{\\sum_{=1}^n (x_i - \\bar{x})^2}\\sqrt{\\sum_{=1}^n (y_i - \\bar{y})^2} }, \\] \\(n\\) number spots locations, \\(\\) \\(j\\) different locations, spots Visium context, \\(x\\) \\(y\\) variables values location, \\(w_{ij}\\) spatial weight, can inversely proportional distance spots indicator whether two spots neighbors, subject various definitions neighborhood. Giotto package implemented something like Lee’s L (Dries et al. 2021). compute Lee’s L top highly variagle genes (HVGs) dataset: bivariate global results can different formats (matrix Lee’s L lists many methods), results stored SFE object. calculateBivariate() function used perform bivariate analyses. Analogous runUnivariate() runBivariate() stores results SFE object, applies local bivariate methods whose results uniform format stored localResults field just like local univariate results. gives spatially informed correlation matrix among genes, can plotted heatmap: coexpression blocks can seen. Note unlike Pearson correlation, diagonal 1, \\[ L_{X,X} = \\frac{\\sum_i (\\tilde x_i - \\bar x)^2}{\\sum_i (x_i - \\bar x)^2} = \\mathrm{SSS}_X, \\] approximated ratio variance spatially lagged \\(x\\) variance \\(x\\). spatial lag introduces smoothing, spatial lag reduced variance, making diagonal less 1. spatial smoothing scalar (SSS), Moran’s approximately Pearson correlation \\(X\\) spatially lagged \\(X\\) (\\(\\tilde X\\)) multiplied SSS: \\[ \\approx \\mathrm{SSS}_X \\cdot \\rho_{X, \\tilde X} \\] Similarly Lee’s L, shown (Lee 2001), \\[ L_{X, Y} = \\sqrt{\\mathrm{SSS}_X}\\sqrt{\\mathrm{SSS}_Y} \\cdot \\rho_{\\tilde X, \\tilde Y} \\] spatial clustering, variance less reduced spatial lag, leading larger SSS. Hence \\(X\\) \\(Y\\) spatially distributed like salt pepper strongly correlated, Lee’s L low lack spatial autocorrelation leads small SSS. Weighted correlation network analysis (WGCNA) (Langfelder Horvath 2008) time honored method find gene co-expression modules, can take correlation matrix. interesting apply WGCNA Lee’s L matrix identify spatially informed gene co-expression modules.","code":"hvgs <- getTopHVGs(sfe_tissue, fdr.threshold = 0.01) res <- calculateBivariate(sfe_tissue, type = \"lee\", feature1 = hvgs) pal_rng <- getDivergeRange(res) pal <- scico(256, begin = pal_rng[1], end = pal_rng[2], palette = \"vik\") pheatmap(res, color = pal, show_rownames = FALSE,           show_colnames = FALSE, cellwidth = 1, cellheight = 1,          treeheight_col = 0, treeheight_row = 0)"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exercises-4","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Bivariate","what":"Exercises","title":"Exploratory spatial data analysis with Voyager","text":"Local Lee’s L analogous local Moran’s – disaggregated form Lee’s L showing contribution spot global Lee’s L. derived (Lee 2001) global Lee’s L shown. Run local Lee’s L two genes choice. can use myofiber type marker genes Myh7, Myh2, Myh4, Myh1. plot results space. Hint: Use localResultFeatures() find name results stored . interpret results? See vignette bivariate methods Voyager applied dataset, including local Lee’s L bivariate version local Moran’s .","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"multivariate","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Multivariate","title":"Exploratory spatial data analysis with Voyager","text":"Spatial transcriptomics data can anywhere hundreds genes whole genome. tedious manually check univariate spatial statistics one gene time. Furthermore, genes often co-regulated, univariate spatial statistics blind co-regulation. Hence multivariate spatial statistics, analyzing multiple genes simultaneously taking spatial information account. Multivariate spatial methods Voyager listed :","code":"listSFEMethods(\"multi\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"non-spatial-pca","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Multivariate","what":"Non-spatial PCA","title":"Exploratory spatial data analysis with Voyager","text":"First run regular principal component analysis (PCA), compare type spatially informed PCA known MULTISPATI PCA (Stéphane Dray, Saı̈d, Débias 2008). Use elbow plot see variance explained PC: Plot top gene loadings PC, contribution gene PC: Plot first 4 PCs space first PC separates leukocyte infiltrated injury site myofibers, PC2 PC3 tease muscle tendon junctions.","code":"hvgs2 <- getTopHVGs(dec, n = 2000) sfe_tissue <- runPCA(sfe_tissue, ncomponents = 20, subset_row = hvgs2,                      exprs_values = \"logcounts\", scale = TRUE,                      BSPARAM = IrlbaParam()) ElbowPlot(sfe_tissue) plotDimLoadings(sfe_tissue, swap_rownames = \"symbol\") spatialReducedDim(sfe_tissue, \"PCA\", 4, divergent = TRUE, diverge_center = 0,                   image_id = \"lowres\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"multispati-pca","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Multivariate","what":"MULTISPATI PCA","title":"Exploratory spatial data analysis with Voyager","text":"Spatially informed dimension reduction actually new, dates back least 1985, Wartenberg’s crossover Moran’s PCA (Wartenberg 1985), generalized developed MULTISPATI PCA (Stéphane Dray, Saı̈d, Débias 2008), implemented adespatial package CRAN. short, PCA tries maximize variance explained PC, MULTISPATI maximizes product Moran’s variance explained. Also, eigenvalues PCA non-negative, covariance matrix positive semidefinite, MULTISPATI can give negative eigenvalues, represent negative spatial autocorrelation, can present interesting common positive spatial autocorrelation often masked latter (Griffith 2019). single cell -omics conventions, let \\(X\\) denote gene count matrix whose columns cells Visium spots whose rows genes, \\(n\\) columns. Let \\(W\\) denote row normalized \\(n\\times n\\) adjacency matrix spatial neighborhood graph cells Visium spots, symmetric. MULTISPATI diagonalizes symmetric matrix \\[ H = \\frac 1 {2n} X(W^t+W)X^t \\] However, implementation adespatial general can used multivariate analyses duality diagram paradigm, correspondence analysis; equation simplified just PCA, without introduce duality diagram . compute MULTISPATI PCA, 20 positive 20 negative eigenvalues. plot positive negative eigenvalues. Note eigenvalues variance explained. Instead, product variance explained Moran’s . positive eigenvalues correspond eigenvectors simultaneously explain variance large positive Moran’s . negative eigenvalues correspond eigenvectors simultaneously explain variance negative Moran’s . positive eigenvalues drop sharply , PC1, none negative eigenvalues seem noteworthy. However, spatial transcriptomics datasets single cell resolution, can negative eigenvalues corresponding PC biologically relevant, see vignette mouse liver data. components mean? component linear combination genes maximize product variance explained Moran’s . second component maximizes product provided ’s orthogonal first component, . loss variance explained usually huge, components can considered axes along spatially coherent groups spots separated much possible according expression highly variable genes, theory, clustering positive MULTISPATI components give spatially coherent clusters. spatial coherence, MULTISPATI might robust outliers. Plot PCs: unlike non-spatial PCA, PC4 continues spatially structured.","code":"sfe_tissue <- runMultivariate(sfe_tissue, \"multispati\", colGraphName = \"visium\",                               nfposi = 20, nfnega = 20, subset_row = hvgs2) ElbowPlot(sfe_tissue, nfnega = 20, reduction = \"multispati\") plotDimLoadings(sfe_tissue, dims = 1:4, reduction = \"multispati\",                 swap_rownames = \"symbol\") spatialReducedDim(sfe_tissue, \"multispati\", 4, divergent = TRUE,                    diverge_center = 0, image_id = \"lowres\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"clustering","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Multivariate > MULTISPATI PCA","what":"Clustering","title":"Exploratory spatial data analysis with Voyager","text":"PCA embeddings often used clustering scRNA-seq data analysis. perform Leiden clustering non-spatial MULTISPATI PCA embeddings. See clustering positive MULTISPATI PCs give spatially coherent clusters Plot clusters space:","code":"set.seed(29) sfe_tissue$clusts_nonspatial <- clusterCells(sfe_tissue, use.dimred = \"PCA\",                                               BLUSPARAM = NNGraphParam(                                                  cluster.fun = \"leiden\",                                                  cluster.args = list(                                                      objective_function = \"modularity\",                                                      resolution_parameter = 1                                                  )                                              )) set.seed(29) sfe_tissue$clusts_multispati <- clusterRows(reducedDim(sfe_tissue, \"multispati\")[,1:20],                                              BLUSPARAM = NNGraphParam(                                                 cluster.fun = \"leiden\",                                                 cluster.args = list(                                                     objective_function = \"modularity\",                                                     resolution_parameter = 1                                                 )                                             )) plotSpatialFeature(sfe_tissue, c(\"clusts_nonspatial\", \"clusts_multispati\"),                     colGeometryName = \"spotPoly\") &      guides(colour = guide_legend(override.aes = list(size=2), ncol = 2))"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"spatial-autocorrelation-of-principal-components","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Multivariate > MULTISPATI PCA","what":"Spatial autocorrelation of principal components","title":"Exploratory spatial data analysis with Voyager","text":"compare Moran’s cell embeddings non-spatial MULTISPATI PC. Just like ’s colDataUnivariate() colDataMoransI() colData columns annotGeometryUnivariate() attributes annotation geometries, univariate spatial statistics can computed cell/spot embeddings reduced dimensions, reducedDimUnivariate(), Moran’s , reducedDimMoransI(). arguments functions similar. lower upper bounds Moran’s given spatial neighborhood graph according (Jong, Sprenger, Veen 1984). lower upper bounds Moran’s plotted horizontal dashed line. non-spatial PCA, Moran’s drops PC1 PC6, Moran’s remains high subsequent MULTISPATI PCs. Given lower bound Moran’s , negative PCs strong negative spatial autocorrelation. However, -interpreted dataset minuscule magnitude negative eigenvalues, means PCs explain little variance.","code":"# non-spatial sfe_tissue <- reducedDimMoransI(sfe_tissue, dimred = \"PCA\", components = 1:20) # spatial sfe_tissue <- reducedDimMoransI(sfe_tissue, dimred = \"multispati\", components = 1:40) df_moran <- tibble(PCA = reducedDimFeatureData(sfe_tissue, \"PCA\")$moran_Vis5A[1:20],                    MULTISPATI_pos =                         reducedDimFeatureData(sfe_tissue, \"multispati\")$moran_Vis5A[1:20],                    MULTISPATI_neg =                         reducedDimFeatureData(sfe_tissue,\"multispati\")$moran_Vis5A[21:40] |>                         rev(),                    index = 1:20) data(\"ditto_colors\") # Takes a while if not using optimized BLAS (mb <- moranBounds(colGraph(sfe_tissue, \"visium\"))) df_moran |>      pivot_longer(cols = -index, values_to = \"value\", names_to = \"name\") |>      ggplot(aes(index, value, color = name)) +     geom_line() +     scale_color_manual(values = ditto_colors) +     geom_hline(yintercept = 0, color = \"gray\") +     geom_hline(yintercept = mb, linetype = 2, color = \"gray\") +     scale_y_continuous(breaks = scales::breaks_pretty()) +     scale_x_continuous(breaks = scales::breaks_width(5)) +     labs(y = \"Moran's I\", color = \"Type\", x = \"Component\")"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"exercises-5","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Multivariate","what":"Exercises","title":"Exploratory spatial data analysis with Voyager","text":"Thought experiment: suppose perform standard PCA MULTISPATI PCA city, buildings, demographics, city divided pixels, whichever spatial features find relevant life. principal components look like? MULTISPATI PC’s differ standard PC’s?","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"further-reading-2","dir":"Articles","previous_headings":"Part 2: Voyager ESDA > Multivariate","what":"Further reading","title":"Exploratory spatial data analysis with Voyager","text":"multivariate spatial method Voyager Bioc 3.17 multivariate generalization local Geary’s C (Anselin 2019). See vignette application dataset. Unlike similar EDA packages spatial -omics data, Voyager extensible, can make uniform user interface run spatial methods, just like Tidymodels. See vignette extending Voyager. spatially informed dimension reduction methods designed spatial -omics data, although tend consider positive spatial autocorrelation. example, see (Shang Zhou 2022) (Velten et al. 2022). paper discusses many types multivariate spatial analyses ecology, besides MULTISPATI PCA (S. Dray et al. 2012). MULTISPATI PCA can thought two extremes. One extreme standard PCA, diagonalizes covariance matrix. extreme Moran eigen map (MEM) (Griffith 1996), uses spatial weights matrix, without data matrix. MEM’s made diagonalizing double centered spatial weights matrix. first eigenvector values make largest possible Moran’s given spatial neighborhood graph. second eigenvector also maximizes Moran’s given ’s orthogonal first eigenvector, . eigenvalues Moran’s multiplied constant. last eigenvector negative Moran’s given spatial neighborhood graph. eigenvectors, MEM’s, represent spatial structures different length scales, can selected used covariates regression account spatial autocorrelation, procedure called spatial filtering (Griffith 2000; Griffith Peres-Neto 2006). See vignette adespatial examples ecology.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"caveats","dir":"Articles","previous_headings":"Part 2: Voyager ESDA","what":"Caveats","title":"Exploratory spatial data analysis with Voyager","text":"H&E image plotted behind geometries can alter perception colors geometries. 2D data supported present, although principle, sf GEOS support 3D data. workshop demonstrates ESDA single sample. However, studies often produce multiple biological replica case control groups. ESDA results can compared across samples, next Bioc 3.18, computed jointly across samples within treatment group.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/articles/voyager.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Exploratory spatial data analysis with Voyager","text":"","code":"sessionInfo()"},{"path":[]},{"path":"https://lambdamoses.github.io/VoaygerHackathon/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lambda Moses. Author, maintainer. Alik Huseynov. Author. Lior Pachter. Author, thesis advisor.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Moses L, Huseynov , Pachter L (2024). VoyagerHackathon: Voyager SFE workshop hackathon Caltech. R package version 1.0.0, https://lambdamoses.github.io/VoyagerHackathon/.","code":"@Manual{,   title = {VoyagerHackathon: Voyager and SFE workshop and hackathon at Caltech},   author = {Lambda Moses and Alik Huseynov and Lior Pachter},   year = {2024},   note = {R package version 1.0.0},   url = {https://lambdamoses.github.io/VoyagerHackathon/}, }"},{"path":"https://lambdamoses.github.io/VoaygerHackathon/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"VoyagerHackathon","text":"website spatial -omics Voyager workshop hackathon Caltech March 4-8, 2024. Event info including schedule workshop material can found website.","code":""},{"path":"https://lambdamoses.github.io/VoaygerHackathon/index.html","id":"description","dir":"","previous_headings":"Overview","what":"Description","title":"VoyagerHackathon","text":"Exploratory spatial data analysis (ESDA) can powerful approach understanding single-cell genomics datasets, yet part standard data analysis workflows. particular, geospatial analyses, developed refined decades, yet fully adapted applied spatial single-cell analysis. introduce Voyager platform, systematically brings geospatial ESDA tradition (spatial) -omics, local, bivariate, multivariate spatial methods yet commonly applied spatial -omics, united uniform user interface. Using Voyager, showcase biological insights can derived methods, biologically relevant negative spatial autocorrelation. Underlying Voyager SpatialFeatureExperiment (SFE) data structure, combines Simple Feature SingleCellExperiment AnnData represent operate geometries bundled gene expression data. Voyager comprehensive tutorials demonstrating ESDA built GitHub Actions ensure reproducibility scalability, using data popular commercial technologies. Voyager implemented R/Bioconductor Python/PyPI, features compatibility tests ensure implementations return consistent results. workshop March 4, get hands experiences R implementation SFE Voyager. First, learn create operate SFE objects. Next perform various types ESDA SFE object Voyager, learn spatial statistics behind methods. workshop material points reading methods. can read Voyager preprint. also learn write R packages use git version control. hackathon March 5-8, implement new features SFE Voyager indicated GitHub repos labeled difficulty. feel like issues challenging, can bring spatial dataset analysis. may also open issues encounter bugs want new features. Current Voyager crew (Lambda Moses Alik Huseynov) answer questions. review pull requests late April Bioconductor 3.19 release. plan split Voyager preprint separate paper SFE. Contributors added coauthors relevant paper.","code":""}]
